clear all;
clc;
close all;

% BEST CONTROLLER FILE TO LOAD IS: feedforward

system=ElasticRoboticSystem();

st=system.getSamplingPeriod;

cs=ControlledSystemScara(system,'Alfa');

max_acc=15;

[file_name, file_path] = uigetfile("controller_*.mat", "Controller");
load([file_path file_name])
disp(file_name)

%%
is_ff = true;
disp(is_ff)
ctrl=ScaraController(st, C1_in, C1_out, tau1_in, tau1_out, M1, C2_in, C2_out, tau2_in, tau2_out, M2, is_ff);
cs.setController(ctrl);
cs.setMaxAcceleration(max_acc);

% simulo il sistema per la valutazione
% "fast" fa 5 esecuzioni
% "complete" fa 5 x 5 esecuzioni (modalità esame)
tic
[score,results]=cs.evalution("fast");
computation_time=toc;
simulated_time=sum([results.Ttot]);
fprintf('Real-time factor = %f\n',simulated_time/computation_time)


% grafico i risultati
fprintf('lo score è %f\n',score);
cs.showResults(results)